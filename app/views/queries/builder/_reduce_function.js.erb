<%
  # This partial defines the reduce function of MapReduce jobs. It handles the logic of blank UI zones, generates functions that match the passed in query_structure,
  # and emits requested information.
%>

function reduce(key, values) {
  
  if (key['type'] == 'magic') {
    var sum = 0;
    
    var result = {rereduce: true}
    
    for(var i in values) {
      sum += values[i]['values'][0]['value'];
    }
    
    result['values'] = [{value:sum}];
    
    return result;
  } else if (key['type'] == 'group') {
    
    var sum = 0;
    
    var result = {rereduce: true}
    
    for(var i in values) {
      sum += values[i]['values'][0]['value'];
    }
    
    result['values'] = [{value:sum}];
    
    return result;
    
    
  }
  
};